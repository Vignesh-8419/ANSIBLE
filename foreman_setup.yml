- name: Run Foreman setup script from GitHub
  hosts: "{{ target_hosts }}"
  become: true
  tasks:

    - name: Download foreman.sh from GitHub to remote host
      become: true
      get_url:
        url: "https://raw.githubusercontent.com/Vignesh-8419/ANSIBLE/main/foreman.sh"
        dest: "/tmp/foreman.sh"
        mode: '0755'
        remote_src: yes

    - name: Create a file in tmp
      become: true
      file:
       path: /tmp/foreman_log.txt
       state: touch
       mode: '0644'
    
    - name: Execute foreman.sh on remote host and store output
      become: true
      shell: "/tmp/foreman.sh > /tmp/foreman_log.txt 2>&1"

    - name: Show Foreman setup log
      command: cat /tmp/foreman_log.txt
      register: foreman_log

    - name: Print log contents
      debug:
        var: foreman_log.stdout_lines
