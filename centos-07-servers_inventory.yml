---
plugin: netbox.netbox.nb_inventory
api_endpoint: https://192.168.253.134
token: d16af27a4c533af154c60b7f6687f824f60183ba
validate_certs: false

# 1. STOP THE SCHEMA FETCH
# This is the most important setting for low-memory servers
validate_query_filters: false
fetch_all: true

# 2. Limit the data being pulled to the bare minimum
config_context: true
interfaces: true
primary_ip: true
services: false

group_by:
  - status
  - tags

# 3. Use your verified filter
query_filters:
  - status: "active"
  - cluster_id: 2

compose:
  ansible_host: primary_ip4.address.split('/')[0]
  primary_ip4: primary_ip4.address.split('/')[0]
